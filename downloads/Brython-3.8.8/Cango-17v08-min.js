var Cango,SVGsegs,circle,arc,ellipse,ellipticalArc,square,rectangle,triangle,cross,ex,segment,Path,Shape,Img,Text,ClipMask,Group,LinearGradient,RadialGradient,initZoomPan;!function(){"use strict";const t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),s=["GRP","PATH","SHAPE","IMG","TEXT","CLIP"];var e={M:"moveTo",L:"lineTo",C:"bezierCurveTo",Z:"closePath"};function i(t){if(t)return JSON.parse(JSON.stringify(t))}SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||function(){var t={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},s=function(t){this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},e=-1!==window.navigator.userAgent.indexOf("MSIE ");s.prototype={parseSegment:function(){var s=this._string[this._currentIndex],e=t[s]?t[s]:null;if(null===e){if(null===this._prevCommand)return null;if(null===(e=("+"===s||"-"===s||"."===s||s>="0"&&"9">=s)&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;this._prevCommand=e;var i=null,r=e.toUpperCase();return"H"===r||"V"===r?i=[this._parseNumber()]:"M"===r||"L"===r||"T"===r?i=[this._parseNumber(),this._parseNumber()]:"S"===r||"Q"===r?i=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===r?i=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===r?i=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===r&&(this._skipOptionalSpaces(),i=[]),null===i||i.indexOf(null)>=0?null:{type:e,values:i}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var s=this._string[this._currentIndex];return t[s]?t[s]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var t=this.peekSegmentType();return"M"===t||"m"===t},_isCurrentSpace:function(){var t=this._string[this._currentIndex];return" ">=t&&(" "===t||"\n"===t||"\t"===t||"\r"===t||"\f"===t)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var t=0,s=0,e=1,i=0,r=1,a=1,h=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,r=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")&&"."!==this._string[this._currentIndex])return null;for(var n=this._currentIndex;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==n)for(var o=this._currentIndex-1,l=1;o>=n;)s+=l*(this._string[o]-"0"),o-=1,l*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)e*=10,i+=(this._string.charAt(this._currentIndex)-"0")/e,this._currentIndex+=1}if(this._currentIndex!==h&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,a=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)t*=10,t+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var c=s+i;return c*=r,t&&(c*=Math.pow(10,a*t)),h===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),c)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var t=null,s=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===s)t=0;else{if("1"!==s)return null;t=1}return this._skipOptionalSpacesOrDelimiter(),t}};var i=function(t){if(!t||0===t.length)return[];var e=new s(t),i=[];if(e.initialCommandIsMoveTo())for(;e.hasMoreData();){var r=e.parseSegment();if(null===r)break;i.push(r)}return i},r=SVGPathElement.prototype.setAttribute,a=SVGPathElement.prototype.removeAttribute,h=window.Symbol?Symbol():"__cachedPathData",n=window.Symbol?Symbol():"__cachedNormalizedPathData",o=function(t,s,e,i,r,a,h,n,l,c){var d,u,p,g,f=function(t,s,e){return{x:t*Math.cos(e)-s*Math.sin(e),y:t*Math.sin(e)+s*Math.cos(e)}},y=function(t){return Math.PI*t/180}(h),v=[];if(c)d=c[0],u=c[1],p=c[2],g=c[3];else{var x=f(t,s,-y);t=x.x,s=x.y;var m=f(e,i,-y),C=(t-(e=m.x))/2,w=(s-(i=m.y))/2,b=C*C/(r*r)+w*w/(a*a);b>1&&(r*=b=Math.sqrt(b),a*=b);var O=r*r,S=a*a,_=O*S-O*w*w-S*C*C,k=O*w*w+S*C*C,I=(n===l?-1:1)*Math.sqrt(Math.abs(_/k));p=I*r*w/a+(t+e)/2,g=I*-a*C/r+(s+i)/2,d=Math.asin(parseFloat(((s-g)/a).toFixed(9))),u=Math.asin(parseFloat(((i-g)/a).toFixed(9))),p>t&&(d=Math.PI-d),p>e&&(u=Math.PI-u),0>d&&(d=2*Math.PI+d),0>u&&(u=2*Math.PI+u),l&&d>u&&(d-=2*Math.PI),!l&&u>d&&(u-=2*Math.PI)}var T=u-d;if(Math.abs(T)>120*Math.PI/180){var P=u,W=e,M=i;u=l&&u>d?d+120*Math.PI/180*1:d+120*Math.PI/180*-1,e=p+r*Math.cos(u),i=g+a*Math.sin(u),v=o(e,i,W,M,r,a,h,0,l,[u,P,p,g])}T=u-d;var A=Math.cos(d),N=Math.sin(d),E=Math.cos(u),G=Math.sin(u),L=Math.tan(T/4),V=4/3*r*L,D=4/3*a*L,H=[t,s],R=[t+V*N,s-D*A],Y=[e+V*G,i-D*E],X=[e,i];if(R[0]=2*H[0]-R[0],R[1]=2*H[1]-R[1],c)return[R,Y,X].concat(v);v=[R,Y,X].concat(v);for(var j=[],B=0;B<v.length;B+=3){r=f(v[B][0],v[B][1],y),a=f(v[B+1][0],v[B+1][1],y);var z=f(v[B+2][0],v[B+2][1],y);j.push([r.x,r.y,a.x,a.y,z.x,z.y])}return j},l=function(t){return t.map(function(t){return{type:t.type,values:Array.prototype.slice.call(t.values)}})},c=function(t){var s=[],e=null,i=null,r=null,a=null,h=null,n=null,l=null;return t.forEach(function(t){if("M"===t.type){var c=t.values[0],d=t.values[1];s.push({type:"M",values:[c,d]}),n=c,l=d,a=c,h=d}else if("C"===t.type){var u=t.values[0],p=t.values[1],g=t.values[2],f=t.values[3];c=t.values[4],d=t.values[5];s.push({type:"C",values:[u,p,g,f,c,d]}),i=g,r=f,a=c,h=d}else if("L"===t.type){c=t.values[0],d=t.values[1];s.push({type:"L",values:[c,d]}),a=c,h=d}else if("H"===t.type){c=t.values[0];s.push({type:"L",values:[c,h]}),a=c}else if("V"===t.type){d=t.values[0];s.push({type:"L",values:[a,d]}),h=d}else if("S"===t.type){g=t.values[0],f=t.values[1],c=t.values[2],d=t.values[3];"C"===e||"S"===e?(y=a+(a-i),v=h+(h-r)):(y=a,v=h),s.push({type:"C",values:[y,v,g,f,c,d]}),i=g,r=f,a=c,h=d}else if("T"===t.type){c=t.values[0],d=t.values[1];"Q"===e||"T"===e?(u=a+(a-i),p=h+(h-r)):(u=a,p=h);var y=a+2*(u-a)/3,v=h+2*(p-h)/3,x=c+2*(u-c)/3,m=d+2*(p-d)/3;s.push({type:"C",values:[y,v,x,m,c,d]}),i=u,r=p,a=c,h=d}else if("Q"===t.type){u=t.values[0],p=t.values[1],c=t.values[2],d=t.values[3],y=a+2*(u-a)/3,v=h+2*(p-h)/3,x=c+2*(u-c)/3,m=d+2*(p-d)/3;s.push({type:"C",values:[y,v,x,m,c,d]}),i=u,r=p,a=c,h=d}else if("A"===t.type){var C=Math.abs(t.values[0]),w=Math.abs(t.values[1]),b=t.values[2],O=t.values[3],S=t.values[4];c=t.values[5],d=t.values[6];if(0===C||0===w)s.push({type:"C",values:[a,h,c,d,c,d]}),a=c,h=d;else if(a!==c||h!==d){o(a,h,c,d,C,w,b,O,S).forEach(function(t){s.push({type:"C",values:t})}),a=c,h=d}}else"Z"===t.type&&(s.push(t),a=n,h=l);e=t.type}),s};SVGPathElement.prototype.setAttribute=function(t,s){"d"===t&&(this[h]=null,this[n]=null),r.call(this,t,s)},SVGPathElement.prototype.removeAttribute=function(t,s){"d"===t&&(this[h]=null,this[n]=null),a.call(this,t)},SVGPathElement.prototype.getPathData=function(t){if(t&&t.normalize){if(this[n])return l(this[n]);this[h]?e=l(this[h]):(e=i(this.getAttribute("d")||""),this[h]=l(e));var s=c(function(t){var s=[],e=null,i=null,r=null,a=null;return t.forEach(function(t){var h=t.type;if("M"===h){var n=t.values[0],o=t.values[1];s.push({type:"M",values:[n,o]}),r=n,a=o,e=n,i=o}else if("m"===h)n=e+t.values[0],o=i+t.values[1],s.push({type:"M",values:[n,o]}),r=n,a=o,e=n,i=o;else if("L"===h)n=t.values[0],o=t.values[1],s.push({type:"L",values:[n,o]}),e=n,i=o;else if("l"===h)n=e+t.values[0],o=i+t.values[1],s.push({type:"L",values:[n,o]}),e=n,i=o;else if("C"===h){var l=t.values[0],c=t.values[1],d=t.values[2],u=t.values[3];n=t.values[4],o=t.values[5],s.push({type:"C",values:[l,c,d,u,n,o]}),e=n,i=o}else"c"===h?(l=e+t.values[0],c=i+t.values[1],d=e+t.values[2],u=i+t.values[3],n=e+t.values[4],o=i+t.values[5],s.push({type:"C",values:[l,c,d,u,n,o]}),e=n,i=o):"Q"===h?(l=t.values[0],c=t.values[1],n=t.values[2],o=t.values[3],s.push({type:"Q",values:[l,c,n,o]}),e=n,i=o):"q"===h?(l=e+t.values[0],c=i+t.values[1],n=e+t.values[2],o=i+t.values[3],s.push({type:"Q",values:[l,c,n,o]}),e=n,i=o):"A"===h?(n=t.values[5],o=t.values[6],s.push({type:"A",values:[t.values[0],t.values[1],t.values[2],t.values[3],t.values[4],n,o]}),e=n,i=o):"a"===h?(n=e+t.values[5],o=i+t.values[6],s.push({type:"A",values:[t.values[0],t.values[1],t.values[2],t.values[3],t.values[4],n,o]}),e=n,i=o):"H"===h?(n=t.values[0],s.push({type:"H",values:[n]}),e=n):"h"===h?(n=e+t.values[0],s.push({type:"H",values:[n]}),e=n):"V"===h?(o=t.values[0],s.push({type:"V",values:[o]}),i=o):"v"===h?(o=i+t.values[0],s.push({type:"V",values:[o]}),i=o):"S"===h?(d=t.values[0],u=t.values[1],n=t.values[2],o=t.values[3],s.push({type:"S",values:[d,u,n,o]}),e=n,i=o):"s"===h?(d=e+t.values[0],u=i+t.values[1],n=e+t.values[2],o=i+t.values[3],s.push({type:"S",values:[d,u,n,o]}),e=n,i=o):"T"===h?(n=t.values[0],o=t.values[1],s.push({type:"T",values:[n,o]}),e=n,i=o):"t"===h?(n=e+t.values[0],o=i+t.values[1],s.push({type:"T",values:[n,o]}),e=n,i=o):("Z"===h||"z"===h)&&(s.push({type:"Z",values:[]}),e=r,i=a)}),s}(e));return this[n]=l(s),s}if(this[h])return l(this[h]);var e=i(this.getAttribute("d")||"");return this[h]=l(e),e},SVGPathElement.prototype.setPathData=function(t){if(0===t.length)e?this.setAttribute("d",""):this.removeAttribute("d");else{for(var s="",i=0,r=t.length;r>i;i+=1){var a=t[i];i>0&&(s+=" "),s+=a.type,a.values&&a.values.length>0&&(s+=" "+a.values.join(" "))}this.setAttribute("d",s)}},SVGRectElement.prototype.getPathData=function(t){var s=this.x.baseVal.value,e=this.y.baseVal.value,i=this.width.baseVal.value,r=this.height.baseVal.value,a=this.hasAttribute("rx")?this.rx.baseVal.value:this.ry.baseVal.value,h=this.hasAttribute("ry")?this.ry.baseVal.value:this.rx.baseVal.value;a>i/2&&(a=i/2),h>r/2&&(h=r/2);var n=[{type:"M",values:[s+a,e]},{type:"H",values:[s+i-a]},{type:"A",values:[a,h,0,0,1,s+i,e+h]},{type:"V",values:[e+r-h]},{type:"A",values:[a,h,0,0,1,s+i-a,e+r]},{type:"H",values:[s+a]},{type:"A",values:[a,h,0,0,1,s,e+r-h]},{type:"V",values:[e+h]},{type:"A",values:[a,h,0,0,1,s+a,e]},{type:"Z",values:[]}];return n=n.filter(function(t){return"A"!==t.type||0!==t.values[0]&&0!==t.values[1]}),t&&!0===t.normalize&&(n=c(n)),n},SVGCircleElement.prototype.getPathData=function(t){var s=this.cx.baseVal.value,e=this.cy.baseVal.value,i=this.r.baseVal.value,r=[{type:"M",values:[s+i,e]},{type:"A",values:[i,i,0,0,1,s,e+i]},{type:"A",values:[i,i,0,0,1,s-i,e]},{type:"A",values:[i,i,0,0,1,s,e-i]},{type:"A",values:[i,i,0,0,1,s+i,e]},{type:"Z",values:[]}];return t&&!0===t.normalize&&(r=c(r)),r},SVGEllipseElement.prototype.getPathData=function(t){var s=this.cx.baseVal.value,e=this.cy.baseVal.value,i=this.rx.baseVal.value,r=this.ry.baseVal.value,a=[{type:"M",values:[s+i,e]},{type:"A",values:[i,r,0,0,1,s,e+r]},{type:"A",values:[i,r,0,0,1,s-i,e]},{type:"A",values:[i,r,0,0,1,s,e-r]},{type:"A",values:[i,r,0,0,1,s+i,e]},{type:"Z",values:[]}];return t&&!0===t.normalize&&(a=c(a)),a},SVGLineElement.prototype.getPathData=function(){return[{type:"M",values:[this.x1.baseVal.value,this.y1.baseVal.value]},{type:"L",values:[this.x2.baseVal.value,this.y2.baseVal.value]}]},SVGPolylineElement.prototype.getPathData=function(){for(var t=[],s=0;s<this.points.numberOfItems;s+=1){var e=this.points.getItem(s);t.push({type:0===s?"M":"L",values:[e.x,e.y]})}return t},SVGPolygonElement.prototype.getPathData=function(){for(var t=[],s=0;s<this.points.numberOfItems;s+=1){var e=this.points.getItem(s);t.push({type:0===s?"M":"L",values:[e.x,e.y]})}return t.push({type:"Z",values:[]}),t}}(),SVGsegs=class extends Array{constructor(t){function s(t){const s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",t),s.getPathData({normalize:!0})}if(t&&0!==t.length){if("string"==typeof t){super(...s(t.replace(/\,/g," ")))}else if(Array.isArray(t)){ArrayBuffer.isView(t)&&(t=Array.from(t));let e="";super(...s(e="number"==typeof t[0]?"M "+t.join(" "):t.join(" ")))}}else super()}toString(t){return function(t,s=4){let e="";return t.forEach(t=>{e=e.concat(t.type);for(let i=0;i<t.values.length;i+=2)e=e.concat(t.values[i].toPrecision(s)+","+t.values[i+1].toPrecision(s)+" ")}),e.trim()}(this,t)}dup(){const t=[];return this.forEach(s=>{t.push(s.type,...s.values)}),new SVGsegs(t)}translate(t=0,s=0){const e=[];return this.forEach(i=>{e.push(i.type);for(let r=0;r<i.values.length;r+=2)e.push(i.values[r]+t,i.values[r+1]+s)}),new SVGsegs(e)}scale(t,s){const e=[],i=t||.001,r=s||i;return this.forEach(t=>{e.push(t.type);for(let s=0;s<t.values.length;s+=2)e.push(t.values[s]*i,t.values[s+1]*r)}),new SVGsegs(e)}rotate(t){const s=[],e=t||0,i=Math.PI/180,r=Math.sin(e*i),a=Math.cos(e*i);return this.forEach(t=>{s.push(t.type);for(let e=0;e<t.values.length;e+=2){let i=t.values[e],h=t.values[e+1];s.push(i*a+h*r,-i*r+h*a)}}),new SVGsegs(s)}skew(t,s){const e=[],i=t||0,r=s||0,a=Math.PI/180,h=Math.tan(-i*a),n=Math.tan(r*a);return this.forEach(t=>{e.push(t.type);for(let s=0;s<t.values.length;s+=2){let i=t.values[s],r=t.values[s+1];e.push(i+r*h,i*n+r)}}),new SVGsegs(e)}appendPath(t){let s=[],e=[];if(!(t instanceof SVGsegs))return void console.warn("TypeError: SVGsegs.appendPath argument 0 not type SVGsegs");t.forEach(t=>{s.push(t.type,...t.values)}),this.forEach(t=>{e.push(t.type,...t.values)});const i=e.concat(s);return new SVGsegs(i)}joinPath(t){const s=this.dup(),e=[];let i;if(t instanceof SVGsegs){if(i=t,0==s.length)i.forEach(t=>{e.push(t.type,...t.values)});else{"Z"==s[s.length-1].type&&(s.length=s.length-1),s.forEach(t=>{e.push(t.type,...t.values)});for(let t=1;t<i.length;t++)e.push(i[t].type,...i[t].values)}return new SVGsegs(e)}console.warn("TypeError: SVGsegs.joinPath argument 0 not type SVGsegs")}revWinding(){let t,s,e,i=this.dup(),r=null;const a=[],h=[];function n(t){const s=[];for(let e=t.length;e>0;e-=2)s.push(t[e-2],t[e-1]);return s}for("Z"===i[i.length-1].type&&(r=i[i.length-1],i.length=i.length-1),s=i[t=i.length-1].values.length,e={type:"M",values:[i[t].values[s-2],i[t].values[s-1]]},a.push(e),i[t].values=i[t].values.slice(0,-2);t>0;)e={type:i[t].type,values:n(i[t].values)},s=i[t-1].values.length,e.values.push(i[t-1].values[s-2],i[t-1].values[s-1]),a.push(e),i[t-1].values=i[t-1].values.slice(0,-2),t-=1;return r&&a.push(r),a.forEach(t=>{h.push(t.type,...t.values)}),new SVGsegs(h)}},segment=(t=>new SVGsegs(t)),circle=function(t=1){return["m",-.5*t,0,"c",0,-.27614*t,.22386*t,-.5*t,.5*t,-.5*t,"c",.27614*t,0,.5*t,.22386*t,.5*t,.5*t,"c",0,.27614*t,-.22386*t,.5*t,-.5*t,.5*t,"c",-.27614*t,0,-.5*t,-.22386*t,-.5*t,-.5*t,"z"]},arc=function(t,s,e){const i=(e%=360)>(s%=360)?1:0,r=Math.abs(e-s)>180?1:0,a=Math.PI*s/180,h=Math.PI*e/180;return["M",t*Math.cos(a),t*Math.sin(a),"A",t,t,0,r,i,t*Math.cos(h),t*Math.sin(h)]},ellipse=function(t,s){const e=t||1;let i=e;return"number"==typeof s&&s>0&&(i=s),["m",-.5*e,0,"c",0,-.27614*i,.22386*e,-.5*i,.5*e,-.5*i,"c",.27614*e,0,.5*e,.22386*i,.5*e,.5*i,"c",0,.27614*i,-.22386*e,.5*i,-.5*e,.5*i,"c",-.27614*e,0,-.5*e,-.22386*i,-.5*e,-.5*i,"z"]},ellipticalArc=function(t,s,e,i,r,a){const h=function(t,s,e,i,r,a,h,n){(a%=2*Math.PI)==(h%=2*Math.PI)&&(h=(h+2*Math.PI-.001*(n?-1:1))%(2*Math.PI));const o=t+e*Math.cos(h),l=s+i*Math.sin(h),c=t+e*Math.cos(a),d=s+i*Math.sin(a),u=n?0:1;let p=0,g=h-a;return g<0&&(g+=2*Math.PI),["M",c,d,"A",e,i,r,p=n?g>Math.PI?0:1:g>Math.PI?1:0,u,o,l]}(0,0,t,s,0,Math.PI*i/180,Math.PI*r/180,a),n=new Path2Dext(h).rotate(-e),o=[];return n.segs.forEach(t=>{o.push(t.type,...t.values)}),o},square=function(t=1){return["m",.5*t,-.5*t,"l",0,t,-t,0,0,-t,"z"]},rectangle=function(t,s,e){const i=t||1,r=s||i;let a;if(void 0===e||e<=0)a=["m",-i/2,-r/2,"l",i,0,0,r,-i,0,"z"];else{const t=Math.min(i/2,r/2,e);a=["m",-i/2+t,-r/2,"l",i-2*t,0,"a",t,t,0,0,1,t,t,"l",0,r-2*t,"a",t,t,0,0,1,-t,t,"l",2*t-i,0,"a",t,t,0,0,1,-t,-t,"l",0,2*t-r,"a",t,t,0,0,1,t,-t,"z"]}return a},triangle=function(t=1){return["m",.5*t,-.289*t,"l",-.5*t,.866*t,-.5*t,-.866*t,"z"]},cross=function(t=1){return["m",-.5*t,0,"l",t,0,"m",-.5*t,-.5*t,"l",0,t]},ex=function(t=1){return["m",-.3535*t,-.3535*t,"l",.707*t,.707*t,"m",-.707*t,0,"l",.707*t,-.707*t]};class r{constructor(t,s,e){this.cgo=null,this.layer=null,this.target=null,this.topCvs=null,this.grabCallback=t||null,this.dragCallback=s||null,this.dropCallback=e||null,this.grabCsrPos={x:0,y:0},this.grabDwgOrg={x:0,y:0},this.grabOfs={x:0,y:0}}grab(t){const s=t||window.event,e=this.cgo.bkgCanvas.layers.length;this.topCvs=this.cgo.bkgCanvas.layers[e-1].cElem,this.topCvs.onmouseup=(t=>{this.drop(t)}),this.topCvs.onmouseout=(t=>{this.drop(t)});const i=this.cgo.getCursorPosWC(s);return this.grabCsrPos.x=i.x,this.grabCsrPos.y=i.y,this.grabDwgOrg.x=this.target.dwgOrg.x,this.grabDwgOrg.y=this.target.dwgOrg.y,this.target.parent?(this.grabOfs.x=i.x-this.grabDwgOrg.x+this.target.parent.dwgOrg.x,this.grabOfs.y=i.y-this.grabDwgOrg.y+this.target.parent.dwgOrg.y):(this.grabOfs.x=i.x-this.grabDwgOrg.x,this.grabOfs.y=i.y-this.grabDwgOrg.y),this.grabCallback&&this.grabCallback(i),this.topCvs.onmousemove=(t=>{this.drag(t)}),s.preventDefault(),!1}drag(t){if(this.dragCallback){const s=this.cgo.getCursorPosWC(t);this.dragCallback(s)}}drop(t){const s=this.cgo.getCursorPosWC(t);this.topCvs.onmouseup=null,this.topCvs.onmouseout=null,this.topCvs.onmousemove=null,this.dropCallback&&this.dropCallback(s)}cancelDrag(t){this.topCvs.onmouseup=null,this.topCvs.onmouseout=null,this.topCvs.onmousemove=null,this.dropCallback&&this.dropCallback(t)}}function a(t,s,e){return{x:t*e.a+s*e.c+e.e,y:t*e.b+s*e.d+e.f}}function h(t){t.a=1,t.b=0,t.c=0,t.d=1,t.e=0,t.f=0}LinearGradient=class{constructor(t,s,e,i){this.grad=[t,s,e,i],this.colorStops=[]}addColorStop(){this.colorStops.push(arguments)}},RadialGradient=class{constructor(t,s,e,i,r,a){this.grad=[t,s,e,i,r,a],this.colorStops=[]}addColorStop(){this.colorStops.push(arguments)}};const n={TRN:function(t){const s=t[0]||0,e=t[1]||0;if(!this.hasOwnProperty("type"))return{x:this.x+s,y:this.y+e};this.ofsTfm=this.ofsTfm.translate(s,e)},SCL:function(t){const s=t[0]||.001,e=t[1]||s;if(!this.hasOwnProperty("type"))return{x:this.x*s,y:this.y*e};this.ofsTfm=this.ofsTfm.scaleNonUniform(s,e)},ROT:function(t){const s=t[0]||0,e=Math.PI/180,i=Math.sin(-s*e),r=Math.cos(-s*e);if(!this.hasOwnProperty("type"))return{x:this.x*r+this.y*i,y:-this.x*i+this.y*r};this.ofsTfm=this.ofsTfm.rotate(s)},SKW:function(t){const s=t[2]||1,e=t[0]||0,i=t[1]||0,r=Math.PI/180,a=Math.tan(-e*r)/s,h=Math.tan(i*r)*s;if(!this.hasOwnProperty("type"))return{x:this.x+this.y*a,y:this.x*h+this.y};this.ofsTfm=this.ofsTfm.skewX(-e),this.ofsTfm=this.ofsTfm.skewY(i)}};class o{constructor(t){const s=Array.prototype.slice.call(arguments).slice(1);this.type=t,this.args=s}}function l(t,s){const e=[1,2,3,4,5,6,7,8,9];if("string"==typeof t&&void 0!==s)switch(t.toLowerCase()){case"fillrule":if("string"!=typeof s)return;"evenodd"!==s&&"nonzero"!==s||(this.fillRule=s);break;case"fillcolor":this.fillCol=s;break;case"strokecolor":this.strokeCol=s;break;case"linewidth":case"strokewidth":"number"==typeof s&&s>0&&(this.lineWidth=s);break;case"linewidthwc":"number"==typeof s&&s>0&&(this.lineWidthWC=s);break;case"linecap":if("string"!=typeof s)return;"butt"!==s&&"round"!==s&&"square"!==s||(this.lineCap=s);break;case"iso":case"isotropic":this.iso=1==s||"iso"===s||"isotropic"===s;break;case"dashed":Array.isArray(s)&&s[0]?this.dashed=s:this.dashed=[];break;case"dashoffset":this.dashOffset=s||0;break;case"border":!0===s&&(this.border=!0),!1===s&&(this.border=!1);break;case"fontsize":"number"==typeof s&&s>0&&(this.fontSize=s);break;case"fontweight":("string"==typeof s||"number"==typeof s&&s>=100&&s<=900)&&(this.fontWeight=s);break;case"fontfamily":"string"==typeof s&&(this.fontFamily=s);break;case"bgfillcolor":this.bgFillColor=s;break;case"imgwidth":this.imgWidth=Math.abs(s);break;case"imgheight":this.imgHeight=Math.abs(s);break;case"lorg":-1!==e.indexOf(s)&&(this.lorg=s);break;case"shadowoffsetx":this.shadowOffsetX=s||0;break;case"shadowoffsety":this.shadowOffsetY=s||0;break;case"shadowblur":this.shadowBlur=s||0;break;case"shadowcolor":this.shadowColor=s;break;case"x":const i=new o("TRN",s,0);this.hardTfmAry.push(i);break;case"y":const r=new o("TRN",0,s);this.hardTfmAry.push(r);break;case"rot":case"degs":const a=new o("ROT",s);this.hardTfmAry.push(a);break;case"scl":const h=0!=s?s:.001,n=new o("SCL",h,h);this.hardTfmAry.push(n);break;case"skewx":const l=new o("SKW",s,0);this.hardTfmAry.push(l);break;case"skewy":const c=new o("SKW",0,s);this.hardTfmAry.push(c);break;default:return}}Group=class{constructor(){this.type="GRP",this.parent=null,this.children=[],this.dwgOrg={x:0,y:0},this.ofsTfmAry=[],this.netTfmAry=[],this.ofsTfm=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this.grpTfm=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this.netTfm=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this.dragNdropHandlers=null,this.addObj.apply(this,arguments)}setProperty(t,s){!function e(i){i.children.forEach(i=>{"GRP"===i.type?e(i):i.setProperty(t,s)})}(this)}deleteObj(t){const s=this.children.indexOf(t);s>=0&&(this.children.splice(s,1),t.parent=null)}addObj(){const t=Array.prototype.slice.call(arguments);for(let e=0;e<t.length;e++)if(Array.isArray(t[e]))for(let i=0;i<t[e].length;i++){if(!s.includes(t[e][i].type))return void console.error("Group.addObj called on bad object type");t[e][i].parent=this,this.children.push(t[e][i]),!t[e][i].dragNdrop&&this.dragNdropHandlers&&(t[e][i].enableDrag.apply(t[e][i],this.dragNdropHandlers),t[e][i].dragNdrop.target=this)}else{if(!t[e]||!s.includes(t[e].type))return void console.error("Group.addObj called on bad object type");t[e].parent=this,this.children.push(t[e]),!t[e].dragNdrop&&this.dragNdropHandlers&&(t[e].enableDrag.apply(t[e],this.dragNdropHandlers),t[e].dragNdrop.target=this)}}enableDrag(t,s,e){const i=this;this.dragNdropHandlers=arguments,function r(a){a.children.forEach(a=>{"GRP"===a.type?r(a):null===a.dragNdrop&&(a.enableDrag(t,s,e),a.dragNdrop.target=i)})}(this)}disableDrag(){this.dragNdropHandlers=void 0,function t(s){s.children.forEach(function(s){"GRP"===s.type?t(s):s.disableDrag()})}(this)}translate(t,s){const e=new o("TRN",t,s);this.ofsTfmAry.push(e)}rotate(t){const s=new o("ROT",t);this.ofsTfmAry.push(s)}skew(t,s){const e=new o("SKW",t,s);this.ofsTfmAry.push(e)}scale(t,s){const e=new o("SCL",t,s);this.ofsTfmAry.push(e)}transformReset(){this.ofsTfmAry=[],h(this.ofsTfm)}};class c{constructor(){this.iso=!0,this.parent=null,this.dwgOrg={x:0,y:0},this.hardTfmAry=[],this.ofsTfmAry=[],this.netTfmAry=[],this.ofsTfm=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this.netTfm=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this.dragNdrop=null}enableDrag(t,s,e){this.dragNdrop=new r(t,s,e),this.dragNdrop.target=this}disableDrag(){if(!this.dragNdrop)return;const t=this.dragNdrop.layer.dragObjects.indexOf(this);this.dragNdrop.layer.dragObjects.splice(t,1),this.dragNdrop=null}translate(t,s){const e=new o("TRN",t,s);this.ofsTfmAry.push(e)}rotate(t){const s=new o("ROT",t);this.ofsTfmAry.push(s)}skew(t,s){const e=new o("SKW",t,s);this.ofsTfmAry.push(e)}scale(t,s){const e=new o("SCL",t,s);this.ofsTfmAry.push(e)}transformReset(){this.ofsTfmAry=[],h(this.ofsTfm)}}ClipMask=class extends c{constructor(t,s){super(),this.type="CLIP",this.drawCmds=[],this.fillRule="nonzero",this.fillColor=null,this.border=!1,this.strokeCol=null,this.lineWidth=null,this.lineWidthWC=null,this.lineCap=null,this.savScale=1,this.iso=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowColor="#000000",this.dashed=[],this.dashOffset=0,this.setDescriptor(t);const e="object"==typeof s?s:{};for(let t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t])}setDescriptor(t){let s,e;t instanceof SVGsegs?this.drawCmds=t.dup():"string"==typeof t&&t.length?(s=t.replace(/\,/g," "),(e=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",s),this.drawCmds=e.getPathData({normalize:!0})):t&&t.length&&(ArrayBuffer.isView(t)&&(t=Array.from(t)),Array.isArray(t)&&(s="number"==typeof t[0]?"M "+t.join(" "):t.join(" "),(e=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",s),this.drawCmds=e.getPathData({normalize:!0})))}setProperty(){l.apply(this,arguments)}dup(){const t=new ClipMask;return t.type=this.type,t.drawCmds=i(this.drawCmds),t.parent=null,t.dwgOrg=i(this.dwgOrg),t.hardTfmAry=i(this.hardTfmAry),t.ofsTfmAry=i(this.ofsTfmAry),t.fillRule=this.fillRule,t.fillCol=this.fillCol,t.border=this.border,t.strokeCol=this.strokeCol,t.lineWidth=this.lineWidth,t.lineWidthWC=this.lineWidthWC,t.lineCap=this.lineCap,t.savScale=1,t.iso=this.iso,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowBlur=this.shadowBlur,t.shadowColor=this.shadowColor,t.dashed=i(this.dashed),t.dashOffset=this.dashOffset,t}},Path=class extends ClipMask{constructor(t,s){super(t,s),this.type="PATH"}},Shape=class extends Path{constructor(t,s){const e=s||{};super(t,s),this.type="SHAPE",this.clearFlag=!1,e.hasOwnProperty("iso")?this.setProperty("iso",e.iso):e.hasOwnProperty("isotropic")?this.setProperty("iso",e.isotropic):this.iso=!0}},Img=class extends c{constructor(t,s){super(),this.type="IMG",this.setDescriptor(t),this.drawCmds=[],this.width=0,this.height=0,this.imgWidth=0,this.imgHeight=0,this.imgLorgX=0,this.imgLorgY=0,this.lorg=1,this.border=!1,this.strokeCol=null,this.lineWidthWC=null,this.lineWidth=null,this.lineCap=null,this.savScale=1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowColor="#000000";const e="object"==typeof s?s:{};for(let t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t])}setDescriptor(t){"string"==typeof t?(this.imgBuf=new Image,this.imgBuf.src=t):t instanceof Image?this.imgBuf=t:t instanceof HTMLCanvasElement?this.imgBuf=t:console.error("Img data type unrecognised")}setProperty(){l.apply(this,arguments)}dup(){const t=new Img(this.imgBuf);return t.type=this.type,t.drawCmds=i(this.drawCmds),t.dwgOrg=i(this.dwgOrg),t.dragNdrop=null,t.hardTfmAry=i(this.hardTfmAry),t.ofsTfmAry=i(this.ofsTfmAry),t.border=this.border,t.strokeCol=this.strokeCol,t.lineWidth=this.lineWidth,t.lineWidthWC=this.lineWidthWC,t.lineCap=this.lineCap,t.savScale=1,t.iso=this.iso,t.dashed=i(this.dashed),t.dashOffset=this.dashOffset,t.width=this.width,t.height=this.height,t.imgWidth=this.imgWidth,t.imgHeight=this.imgHeight,t.imgLorgX=this.imgLorgX,t.imgLorgY=this.imgLorgY,t.lorg=this.lorg,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowBlur=this.shadowBlur,t.shadowColor=this.shadowColor,t}formatImg(t){const s=Math.abs(t.yscl/t.xscl);let e,i,r=0,a=0;this.iso=!0,this.imgBuf.width||console.log("in image onload handler yet image NOT loaded!"),this.imgWidth&&this.imgHeight?(e=this.imgWidth,i=this.imgHeight*s):this.imgWidth&&!this.imgHeight?i=(e=this.imgWidth)*this.imgBuf.height/this.imgBuf.width:this.imgHeight&&!this.imgWidth?e=(i=this.imgHeight*s)*this.imgBuf.width/this.imgBuf.height:i=(e=this.imgBuf.width)*this.imgBuf.height/this.imgBuf.width;const h=e/2,n=i/2,o=[0,[0,0],[h,0],[e,0],[0,n],[h,n],[e,n],[0,i],[h,i],[e,i]];void 0!==o[this.lorg]&&(r=-o[this.lorg][0],a=-o[this.lorg][1]),this.imgLorgX=r,this.imgLorgY=a,this.width=e,this.height=i;const l=r,c=a,d=r,u=a+i,p=r+e,g=a+i,f=r+e,y=a;this.drawCmds=[{type:"M",values:[l,c]},{type:"L",values:[d,u]},{type:"L",values:[p,g]},{type:"L",values:[f,y]},{type:"Z",values:[]}]}},Text=class extends c{constructor(t,s){super(),this.type="TEXT",this.txtStr="",this.drawCmds=[],this.width=0,this.height=0,this.imgLorgX=0,this.imgLorgY=0,this.lorg=1,this.border=!1,this.fillCol=null,this.bgFillColor=null,this.strokeCol=null,this.fontSize=null,this.fontSizeZC=null,this.fontWeight=null,this.fontFamily=null,this.lineWidthWC=null,this.lineWidth=null,this.lineCap=null,this.savScale=1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowColor="#000000",this.setDescriptor(t);const e="object"==typeof s?s:{};for(let t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t])}setDescriptor(t){"string"!=typeof t?console.error("Text data type not a string"):this.txtStr=t}setProperty(){l.apply(this,arguments)}dup(){const t=new Text(this.txtStr.slice(0));return t.type=this.type,t.drawCmds=i(this.drawCmds),t.dwgOrg=i(this.dwgOrg),t.hardTfmAry=i(this.hardTfmAry),t.ofsTfmAry=i(this.ofsTfmAry),t.border=this.border,t.strokeCol=this.strokeCol,t.fillCol=this.fillCol,t.bgFillColor=this.bgFillColor,t.lineWidth=this.lineWidth,t.lineWidthWC=this.lineWidthWC,t.lineCap=this.lineCap,t.savScale=1,t.dashed=i(this.dashed),t.dashOffset=this.dashOffset,t.width=this.width,t.height=this.height,t.imgLorgX=this.imgLorgX,t.imgLorgY=this.imgLorgY,t.lorg=this.lorg,t.fontSize=this.fontSize,t.fontWeight=this.fontWeight,t.fontFamily=this.fontFamily,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowBlur=this.shadowBlur,t.shadowColor=this.shadowColor,t}formatText(t){const s=this.fontSize||t.fontSize,e=this.fontFamily||t.fontFamily,i=this.fontWeight||t.fontWeight,r=this.lorg||1;let a,h,n,o=0,l=0;var c,d;this.orgXscl||(this.orgXscl=t.xscl),n=t.xscl/this.orgXscl,this.fontSizeZC=s*n,t.ctx.save(),c=t.ctx,void 0===d?c.setTransform(1,0,0,0,1,0):c.setTransform(d.matrix[0][0],d.matrix[0][1],d.matrix[1][0],d.matrix[1][1],d.matrix[2][0],d.matrix[2][1]),t.ctx.font=i+" "+s+"px "+e,a=t.ctx.measureText(this.txtStr).width,t.ctx.restore(),h=s;const u=(a*=n)/2,p=(h*=n)/2,g=[0,[0,h],[u,h],[a,h],[0,p],[u,p],[a,p],[0,0],[u,0],[a,0]];void 0!==g[r]&&(o=-g[r][0],l=g[r][1]),this.imgLorgX=o,this.imgLorgY=l-.25*h;const f=o,y=l,v=o,x=l-h,m=o+a,C=l-h,w=o+a,b=l;this.drawCmds=[{type:"M",values:[f,y]},{type:"L",values:[v,x]},{type:"L",values:[m,C]},{type:"L",values:[w,b]},{type:"Z",values:[]}]}};class d{constructor(t,s){this.id=t,this.cElem=s,this.dragObjects=[]}}function u(t){let s=t.bkgCanvas.layers[0];for(let e=1;e<t.bkgCanvas.layers.length;e++)if(t.bkgCanvas.layers[e].id===t.cId){s=t.bkgCanvas.layers[e];break}return s}(Cango=class{constructor(s){const i=()=>{const t=this.bkgCanvas.offsetTop+this.bkgCanvas.clientTop,s=this.bkgCanvas.offsetLeft+this.bkgCanvas.clientLeft,e=this.bkgCanvas.offsetWidth,i=this.bkgCanvas.offsetHeight;if(!(Math.abs(e-this.rawWidth)/e<.01&&Math.abs(i-this.rawHeight)/i<.01)&&(this.bkgCanvas.timeline&&this.bkgCanvas.timeline.animTasks.length&&this.deleteAllAnimations(),this.rawWidth=e,this.rawHeight=i,this.aRatio=e/i,this.bkgCanvas===this.cnvs)){this.cnvs.width=e,this.cnvs.height=i;for(let r=1;r<this.bkgCanvas.layers.length;r++){let a=this.bkgCanvas.layers[r].cElem;a&&(a.style.top=t+"px",a.style.left=s+"px",a.style.width=e+"px",a.style.height=i+"px",a.width=e,a.height=i)}}};if("string"==typeof s&&document.getElementById(s)){if(this.cnvs=document.getElementById(s),this.cId=s,!(this.cnvs instanceof HTMLCanvasElement))return void console.error("TypeError: Cango target not an HTMLCanvasElement");if(-1!==this.cId.indexOf("_ovl_")){this.cgoType="OVL";const t=this.cId.slice(0,this.cId.indexOf("_ovl_"));this.bkgCanvas=document.getElementById(t)}else this.cgoType="BKG",this.bkgCanvas=this.cnvs;this.rawWidth=this.cnvs.offsetWidth,this.rawHeight=this.cnvs.offsetHeight,this.bkgCanvas.hasOwnProperty("unique")||(this.bkgCanvas.unique=0)}else{if(!(s instanceof HTMLCanvasElement))return void console.error("TypeError: Cango target element is undefined");this.cnvs=s,this.bkgCanvas=this.cnvs,this.rawWidth=this.cnvs.width,this.rawHeight=this.cnvs.height,this.bkgCanvas.hasOwnProperty("unique")||(this.bkgCanvas.unique=0),document.contains(s)?(this.cId=this.cnvs.id,this.cgoType="BKG",this.cId||(this.cId="_bkg_"+this.getUnique(),this.cnvs.id=this.cId)):(this.cId="_os_"+this.getUnique(),this.cgoType="OS")}if(this.aRatio=this.rawWidth/this.rawHeight,this.widthPW=100,this.heightPW=100/this.aRatio,!this.bkgCanvas.hasOwnProperty("layers")){this.bkgCanvas.layers=[];const t=new d(this.cId,this.cnvs);if(this.bkgCanvas.layers[0]=t,"OS"!==this.cgoType){let t=void 0;window.addEventListener("resize",()=>{null!=t&&(clearTimeout(t),t=void 0),t=setTimeout(()=>{t=void 0,i()},250)})}}"undefined"==typeof Timeline||this.bkgCanvas.hasOwnProperty("timeline")||(this.bkgCanvas.timeline=new Timeline),this.cnvs.hasOwnProperty("resized")||(this.cnvs.width=this.rawWidth,this.cnvs.height=this.rawHeight,this.cnvs.resized=!0),this.ctx=this.cnvs.getContext("2d"),this.yDown=!0,this.vpW=this.rawWidth,this.vpH=this.rawHeight,this.vpOrgX=0,this.vpOrgYsvg=0,this.vpOrgYrhc=this.rawHeight,this.vpOrgY=this.vpOrgYsvg,this.xscl=1,this.yscl=1,this.xoffset=0,this.yoffset=0,this.savWC={xscl:this.xscl,yscl:this.yscl,xoffset:this.xoffset,yoffset:this.yoffset},this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",this.penCol="rgba(0, 0, 0, 1.0)",this.penWid=1,this.lineCap="butt",this.paintCol="rgba(128,128,128,1.0)",this.fontSize=12,this.fontWeight=400,this.fontFamily="Consolas, Monaco, 'Andale Mono', monospace",this.clipCount=0,(()=>{this.cnvs.onmousedown=(s=>{const i=s||window.event,r=(s,i,r)=>{const a=s.dragNdrop.cgo,h=a.yDown?a.xscl:-a.xscl;let n,o=t.translate(a.vpOrgX+a.xoffset,a.vpOrgY+a.yoffset).scaleNonUniform(a.xscl,h).multiply(s.netTfm);return"IMG"!==s.type||a.yDown?"TEXT"===s.type&&(o=o.scaleNonUniform(1/a.xscl,1/h)):o=o.flipY(),a.ctx.save(),a.ctx.setTransform(o.a,o.b,o.c,o.d,o.e,o.f),a.ctx.beginPath(),s.drawCmds.forEach(function(t){a.ctx[e[t.type]].apply(a.ctx,t.values)}),n=a.ctx.isPointInPath(i,r),a.ctx.restore(),n},a=(t=>{const s=this.cnvs.getBoundingClientRect();return{x:t.clientX-s.left,y:t.clientY-s.top}})(i);t:for(let t=this.bkgCanvas.layers.length-1;t>=0;t--){let s=this.bkgCanvas.layers[t];for(let t=s.dragObjects.length-1;t>=0;t--){let e=s.dragObjects[t];if(r(e,a.x,a.y)&&e.dragNdrop){e.dragNdrop.grab(i);break t}}}})})()}}).prototype.getUnique=function(){return this.bkgCanvas.unique+=1,this.bkgCanvas.unique},Cango.prototype.toPixelCoords=function(t,s){return{x:this.vpOrgX+this.xoffset+t*this.xscl,y:this.vpOrgY+this.yoffset+s*this.yscl}},Cango.prototype.toWorldCoords=function(t,s){return{x:(t-this.vpOrgX-this.xoffset)/this.xscl,y:(s-this.vpOrgY-this.yoffset)/this.yscl}},Cango.prototype.getCursorPosWC=function(t){const s=t||window.event,e=this.cnvs.getBoundingClientRect();return this.toWorldCoords(s.clientX-e.left,s.clientY-e.top)},Cango.prototype.clearCanvas=function(t){const s=t=>{const s=this.toPixelCoords(t.grad[0],t.grad[1]),e=this.toPixelCoords(t.grad[2],t.grad[3]),i=this.ctx.createLinearGradient(s.x,s.y,e.x,e.y);return t.colorStops.forEach(t=>{i.addColorStop(t[0],t[1])}),i},e=t=>{const s=this.toPixelCoords(t.grad[0],t.grad[1]),e=t.grad[2]*this.xscl,i=this.toPixelCoords(t.grad[3],t.grad[4]),r=t.grad[5]*this.xscl,a=this.ctx.createRadialGradient(s.x,s.y,e,i.x,i.y,r);return t.colorStops.forEach(t=>{a.addColorStop(t[0],t[1])}),a};t?(this.ctx.save(),this.ctx.fillStyle=t instanceof LinearGradient?s(t):t instanceof RadialGradient?e(t):t,this.ctx.fillRect(0,0,this.rawWidth,this.rawHeight),this.ctx.restore()):this.ctx.clearRect(0,0,this.rawWidth,this.rawHeight),u(this).dragObjects.length=0,this.cnvs.alphaOvl&&this.cnvs.alphaOvl.parentNode&&this.cnvs.alphaOvl.parentNode.removeChild(this.cnvs.alphaOvl)},Cango.prototype.gridboxPadding=function(t,s,e,i){const r=()=>{this.vpW=this.rawWidth,this.vpH=this.rawHeight,this.vpOrgX=0,this.vpOrgY=0,this.setWorldCoordsSVG()};if(void 0===t)return void r();if(void 0===s){if(t>=50||t<0)return console.error("gridbox right must be greater than left"),void r();s=t}(t<0||t>99)&&(t=0),(s<0||s>99/this.aRatio)&&(s=0),void 0===e?e=t:e<0&&(e=0),void 0===i?i=s:i<0&&(i=0);const a=100-t-e,h=100/this.aRatio-i-s;if(a<0||h<0)return console.error("invalid gridbox dimensions"),void r();this.vpW=a*this.rawWidth/100,this.vpH=h*this.rawWidth/100,this.vpOrgX=t*this.rawWidth/100,this.vpOrgYsvg=i*this.rawWidth/100,this.vpOrgYrhc=this.vpOrgYsvg+this.vpH,this.vpOrgY=this.vpOrgYsvg,this.yDown=!0,this.setWorldCoordsSVG()},Cango.prototype.fillGridbox=function(t){const s=t||this.paintCol,e=this.vpOrgYsvg,i=t=>{const s=this.toPixelCoords(t.grad[0],t.grad[1]),e=this.toPixelCoords(t.grad[2],t.grad[3]),i=this.ctx.createLinearGradient(s.x,s.y,e.x,e.y);return t.colorStops.forEach(t=>{i.addColorStop(t[0],t[1])}),i},r=t=>{const s=this.toPixelCoords(t.grad[0],t.grad[1]),e=t.grad[2]*this.xscl,i=this.toPixelCoords(t.grad[3],t.grad[4]),r=t.grad[5]*this.xscl,a=this.ctx.createRadialGradient(s.x,s.y,e,i.x,i.y,r);return t.colorStops.forEach(t=>{a.addColorStop(t[0],t[1])}),a};this.ctx.save(),this.ctx.fillStyle=s instanceof LinearGradient?i(s):s instanceof RadialGradient?r(s):s,this.ctx.fillRect(this.vpOrgX,e,this.vpW,this.vpH),this.ctx.restore()},Cango.prototype.setWorldCoordsSVG=function(t,s,e,i){const r=t||0,a=s||0;this.yDown=!0,this.vpOrgY=this.vpOrgYsvg,this.xscl=e&&e>0?this.vpW/e:1,this.yscl=i&&i>0?this.vpH/i:this.xscl,this.xoffset=-r*this.xscl,this.yoffset=-a*this.yscl,this.savWC={xscl:this.xscl,yscl:this.yscl,xoffset:this.xoffset,yoffset:this.yoffset}},Cango.prototype.setWorldCoordsRHC=function(t,s,e,i){const r=t||0,a=s||0;this.yDown=!1,this.vpOrgY=this.vpOrgYrhc,this.xscl=e&&e>0?this.vpW/e:1,this.yscl=i&&i>0?-this.vpH/i:-this.xscl,this.xoffset=-r*this.xscl,this.yoffset=-a*this.yscl,this.savWC={xscl:this.xscl,yscl:this.yscl,xoffset:this.xoffset,yoffset:this.yoffset}},Cango.prototype.setPropertyDefault=function(t,s){if("string"==typeof t&&null!=s)switch(t.toLowerCase()){case"fillcolor":"string"!=typeof s&&"object"!=typeof s||(this.paintCol=s);break;case"strokecolor":"string"!=typeof s&&"object"!=typeof s||(this.penCol=s);break;case"linewidth":case"strokewidth":this.penWid=s;break;case"linecap":"string"!=typeof s||"butt"!==s&&"round"!==s&&"square"!==s||(this.lineCap=s);break;case"fontfamily":"string"==typeof s&&(this.fontFamily=s);break;case"fontsize":this.fontSize=s;break;case"fontweight":("string"==typeof s||s>=100&&s<=900)&&(this.fontWeight=s);break;case"steptime":s>=15&&s<=500&&(this.bkgCanvas.timeline.stepTime=s);break;case"framerate":s&&"auto"===s?this.bkgCanvas.timeline.frameRate=void 0:isNaN(s)||s>50||s<=.5?console.error('invalid frame rate ["auto" or value 0.5 .. 50 lines/sec]'):this.bkgCanvas.timeline.frameRate=s;break;default:return}},Cango.prototype.dropShadow=function(t){let s=0,e=0,i=0,r="#000000",a=1,h=1;null!=t&&(s=t.shadowOffsetX||0,e=t.shadowOffsetY||0,i=t.shadowBlur||0,r=t.shadowColor||"#000000","SHAPE"===t.type||"PATH"===t.type&&!t.iso?(a*=this.xscl,h*=this.yscl):(a*=this.xscl,h*=-this.xscl)),this.ctx.shadowOffsetX=s*a,this.ctx.shadowOffsetY=e*h,this.ctx.shadowBlur=i*a,this.ctx.shadowColor=r},Cango.prototype.render=function(t,e){const i=Math.abs(this.yscl/this.xscl);function r(t){if(!t.iso){const s=new o("SCL",1,i);t.netTfmAry.unshift(s)}h(t.ofsTfm),t.savScale=1,t.netTfmAry.reverse().forEach(function(s){"SCL"===s.type&&(t.savScale*=Math.abs(s.args[0])),"TRN"===s.type?n[s.type].call(t,[s.args[0],s.args[1]*i]):"SKW"===s.type?t.iso?n[s.type].call(t,[s.args[0],s.args[1]]):n[s.type].call(t,[s.args[0],s.args[1],i]):n[s.type].call(t,s.args)}),t.netTfm=t.ofsTfm.multiply(t.grpTfm)}function a(t){let s,e,r;t.parent?(s=t.parent.netTfmAry,e=t.parent.netTfm):(s=[],e=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix());const a=[];t.ofsTfmAry.forEach(t=>{a.push(t)}),t.ofsTfmAry=a,r=t.ofsTfmAry.concat(s),"GRP"===t.type?t.netTfmAry=r:(t.netTfmAry=t.hardTfmAry.concat(r),t.grpTfm=e),t.dwgOrg={x:0,y:0},r.forEach(s=>{"SKW"!==s.type||t.iso?t.dwgOrg=n[s.type].call(t.dwgOrg,s.args):t.dwgOrg=n[s.type].call(t.dwgOrg,[s.args[0],s.args[1],i])})}const l=t=>{const s=()=>{t.formatImg(this),r(t),this.paintImg(t)};"IMG"===t.type?t.imgBuf.complete||t.imgBuf instanceof HTMLCanvasElement?s():t.imgBuf.addEventListener("load",s):"TEXT"===t.type?(t.formatText(this),r(t),this.paintText(t)):"CLIP"===t.type?(r(t),this.applyClipMask(t)):(r(t),this.paintPath(t))};if(s.includes(t.type)){if(!0===e&&this.clearCanvas(),"GRP"===t.type){(function(){const s=[];return function t(e,i){e(i),"GRP"===i.type?i.children.forEach(function(s){t(e,s)}):s.push(i)}(a,t),s})().forEach(l)}else a(t),l(t);!function t(s){s.transformReset(),"GRP"===s.type&&s.children.forEach(function(s){t(s)})}(t),this.resetClip()}else console.error("render called on bad object type")},Cango.prototype.genLinGrad=function(t,s){const e=t.grad[0],i=t.grad[1],r=t.grad[2],h=t.grad[3],n=a(e,i,s),o=a(r,h,s),l=this.ctx.createLinearGradient(n.x,n.y,o.x,o.y);return t.colorStops.forEach(function(t){l.addColorStop(t[0],t[1])}),l},Cango.prototype.genRadGrad=function(t,s,e){const i=t.grad[0],r=t.grad[1],h=t.grad[2]*e,n=t.grad[3],o=t.grad[4],l=t.grad[5]*e,c=a(i,r,s),d=a(n,o,s),u=this.ctx.createRadialGradient(c.x,c.y,h,d.x,d.y,l);return t.colorStops.forEach(function(t){u.addColorStop(t[0],t[1])}),u},Cango.prototype.paintImg=function(s){const i=s.imgBuf,r=this.yDown?this.xscl:-this.xscl;let a=t.translate(this.vpOrgX+this.xoffset,this.vpOrgY+this.yoffset).scaleNonUniform(this.xscl,r).multiply(s.netTfm);if(this.yDown||(a=a.flipY()),this.ctx.save(),this.ctx.setTransform(a.a,a.b,a.c,a.d,a.e,a.f),this.dropShadow(s),this.ctx.drawImage(i,s.imgLorgX,s.imgLorgY,s.width,s.height),s.border){this.ctx.beginPath(),s.drawCmds.forEach(t=>{this.ctx[e[t.type]].apply(this.ctx,t.values)}),this.ctx.restore(),this.ctx.save();const t=s.strokeCol||this.penCol;let i=t;t instanceof LinearGradient?i=this.genLinGrad(t,a):t instanceof RadialGradient&&(i=this.genRadGrad(t,a,s.savScale*this.xscl)),s.lineWidthWC?this.ctx.lineWidth=s.lineWidthWC*s.savScale*this.xscl:this.ctx.lineWidth=s.lineWidth||this.penWid,this.ctx.strokeStyle=i,this.ctx.lineCap=s.lineCap||this.lineCap,this.ctx.stroke()}if(this.ctx.restore(),null!==s.dragNdrop){const t=u(this);if(t!==s.dragNdrop.layer&&s.dragNdrop.layer){const t=s.dragNdrop.layer.dragObjects.indexOf(this);-1!==t&&s.dragNdrop.layer.dragObjects.splice(t,1)}s.dragNdrop.cgo=this,s.dragNdrop.layer=t,s.dragNdrop.layer.dragObjects.includes(s)||s.dragNdrop.layer.dragObjects.push(s)}},Cango.prototype.paintPath=function(s){const i=this.yDown?this.xscl:-this.xscl,r=t.translate(this.vpOrgX+this.xoffset,this.vpOrgY+this.yoffset).scaleNonUniform(this.xscl,i).multiply(s.netTfm);let a,h,n;if(s.drawCmds.length){if(this.ctx.save(),this.ctx.transform(r.a,r.b,r.c,r.d,r.e,r.f),this.ctx.beginPath(),s.drawCmds.forEach(t=>{this.ctx[e[t.type]].apply(this.ctx,t.values)}),this.ctx.restore(),this.ctx.save(),h=(a=s.fillCol||this.paintCol)instanceof LinearGradient?this.genLinGrad(a,r):a instanceof RadialGradient?this.genRadGrad(a,r,s.savScale*this.xscl):a,n=(a=s.strokeCol||this.penCol)instanceof LinearGradient?this.genLinGrad(a,r):a instanceof RadialGradient?this.genRadGrad(a,r,s.savScale*this.xscl):a,this.dropShadow(s),"SHAPE"===s.type&&(this.ctx.fillStyle=h,s.clearFlag?(this.ctx.save(),this.ctx.globalCompositeOperation="destination-out",this.ctx.fill(s.fillRule),this.ctx.restore()):this.ctx.fill(s.fillRule)),("PATH"===s.type||s.border)&&(s.border&&this.dropShadow(),Array.isArray(s.dashed)&&s.dashed.length&&(this.ctx.setLineDash(s.dashed),this.ctx.lineDashOffset=s.dashOffset||0),s.lineWidthWC?this.ctx.lineWidth=s.lineWidthWC*s.savScale*this.xscl:this.ctx.lineWidth=s.lineWidth||this.penWid,this.ctx.strokeStyle=n,this.ctx.lineCap=s.lineCap||this.lineCap,this.ctx.stroke(),this.ctx.setLineDash([]),this.ctx.lineDashOffset=0),this.ctx.restore(),null!==s.dragNdrop){const t=u(this);if(t!==s.dragNdrop.layer&&s.dragNdrop.layer){const t=s.dragNdrop.layer.dragObjects.indexOf(this);-1!==t&&s.dragNdrop.layer.dragObjects.splice(t,1)}s.dragNdrop.cgo=this,s.dragNdrop.layer=t,s.dragNdrop.layer.dragObjects.includes(s)||s.dragNdrop.layer.dragObjects.push(s)}}else console.warn("Attempt to draw an object with 0 length descriptor")},Cango.prototype.applyClipMask=function(s){if(!s.drawCmds.length)return void this.resetClip();const i=this.yDown?this.xscl:-this.xscl,r=t.translate(this.vpOrgX+this.xoffset,this.vpOrgY+this.yoffset).scaleNonUniform(this.xscl,i).multiply(s.netTfm);this.ctx.save(),this.clipCount+=1,this.ctx.save(),this.ctx.transform(r.a,r.b,r.c,r.d,r.e,r.f),this.ctx.beginPath(),s.drawCmds.forEach(t=>{this.ctx[e[t.type]].apply(this.ctx,t.values)}),this.ctx.closePath(),this.ctx.restore(),this.ctx.clip(s.fillRule),this.ctx.fillStyle="rgba(0, 0, 0, 0.0)",this.ctx.fillRect(0,0,1,1)},Cango.prototype.resetClip=function(){for(;this.clipCount>0;)this.ctx.restore(),this.clipCount--},Cango.prototype.paintText=function(s){const i=this.yDown?this.xscl:-this.xscl,r=t.translate(this.vpOrgX+this.xoffset,this.vpOrgY+this.yoffset).scaleNonUniform(this.xscl,i).multiply(s.netTfm).scaleNonUniform(1/this.xscl,1/i),a=s.fontWeight||this.fontWeight,h=s.fontSizeZC,n=s.fontFamily||this.fontFamily;if(this.ctx.save(),this.ctx.setTransform(r.a,r.b,r.c,r.d,r.e,r.f),"string"==typeof s.bgFillColor&&(this.ctx.save(),this.ctx.fillStyle=s.bgFillColor,this.ctx.strokeStyle=s.bgFillColor,this.ctx.lineWidth=.1*h,this.ctx.beginPath(),s.drawCmds.forEach(t=>{this.ctx[e[t.type]].apply(this.ctx,t.values)}),this.ctx.fill(),this.ctx.stroke(),this.ctx.restore()),this.ctx.font=a+" "+h+"px "+n,this.ctx.fillStyle=s.fillCol||this.paintCol,this.ctx.fillText(s.txtStr,s.imgLorgX,s.imgLorgY),s.border&&(this.dropShadow(),s.lineWidthWC?this.ctx.lineWidth=s.lineWidthWC*this.xscl:this.ctx.lineWidth=s.lineWidth||this.penWid,this.ctx.strokeStyle=s.strokeCol||this.penCol,this.ctx.lineCap=s.lineCap||this.lineCap,this.ctx.strokeText(s.txtStr,s.imgLorgX,s.imgLorgY)),this.ctx.restore(),null!==s.dragNdrop){const t=u(this);if(t!==s.dragNdrop.layer&&s.dragNdrop.layer){const t=s.dragNdrop.layer.dragObjects.indexOf(this);-1!==t&&s.dragNdrop.layer.dragObjects.splice(t,1)}s.dragNdrop.cgo=this,s.dragNdrop.layer=t,s.dragNdrop.layer.dragObjects.includes(s)||s.dragNdrop.layer.dragObjects.push(s)}},Cango.prototype.drawPath=function(t,s){const e=new Path(t,s);this.render(e)},Cango.prototype.drawShape=function(t,s){const e=new Shape(t,s);this.render(e)},Cango.prototype.drawText=function(t,s){const e=new Text(t,s);this.render(e)},Cango.prototype.drawImg=function(t,s){const e=new Img(t,s);this.render(e)},Cango.prototype.clearShape=function(t,s){const e=new Shape(t,s);e.fillCol="rgba(0,0,0,1.0)",e.clearFlag=!0,this.render(e)},Cango.prototype.createLayer=function(){const t=this.rawWidth,s=this.rawHeight,e=this.bkgCanvas.layers.length;if("OVL"===this.cgoType||"OS"===this.cgoType)return console.log("offscreen canvases and layers cannot create layers"),"";const i=this.cId+"_ovl_"+this.getUnique(),r="<canvas id='"+i+"' style='position:absolute' width='"+t+"' height='"+s+"'></canvas>";this.bkgCanvas.layers[e-1].cElem.insertAdjacentHTML("afterend",r);const a=document.getElementById(i);a.style.backgroundColor="transparent",a.style.left=this.bkgCanvas.offsetLeft+this.bkgCanvas.clientLeft+"px",a.style.top=this.bkgCanvas.offsetTop+this.bkgCanvas.clientTop+"px",a.style.width=this.bkgCanvas.offsetWidth+"px",a.style.height=this.bkgCanvas.offsetHeight+"px";const h=new d(i,a);return this.bkgCanvas.layers.push(h),i},Cango.prototype.deleteLayer=function(t){for(let s=1;s<this.bkgCanvas.layers.length;s++)if(this.bkgCanvas.layers[s].id===t){let t=this.bkgCanvas.layers[s].cElem;t&&(t.alphaOvl&&t.alphaOvl.parentNode&&t.alphaOvl.parentNode.removeChild(t.alphaOvl),t.parentNode.removeChild(t)),this.bkgCanvas.layers.splice(s,1)}},Cango.prototype.deleteAllLayers=function(){for(let t=this.bkgCanvas.layers.length-1;t>0;t--){let s=this.bkgCanvas.layers[t].cElem;s&&(s.alphaOvl&&s.alphaOvl.parentNode&&s.alphaOvl.parentNode.removeChild(s.alphaOvl),s.parentNode.removeChild(s)),this.bkgCanvas.layers.splice(t,1)}},Cango.prototype.dupCtx=function(t){this.yDown=t.yDown,this.vpW=t.vpW,this.vpH=t.vpH,this.vpOrgYsvg=t.vpOrgYsvg,this.vpOrgYrhc=t.vpOrgYrhc,this.vpOrgX=t.vpOrgX,this.vpOrgY=t.vpOrgY,this.xscl=t.xscl,this.yscl=t.yscl,this.xoffset=t.xoffset,this.yoffset=t.yoffset,this.savWC=i(t.savWC),this.penCol=t.penCol.slice(0),this.penWid=t.penWid,this.lineCap=t.lineCap.slice(0),this.paintCol=t.paintCol.slice(0),this.fontSize=t.fontSize,this.fontWeight=t.fontWeight,this.fontFamily=t.fontFamily.slice(0)},initZoomPan=function(t,s,e){const i=Array.isArray(s)?s:[s],r=["m",-7,-2,"l",7,5,7,-5];function a(t){i.forEach(s=>{const e=s.toPixelCoords(0,0),i=s.rawWidth/2-e.x,r=s.rawHeight/2-e.y;s.xoffset+=i-i/t,s.yoffset+=r-r/t,s.xscl/=t,s.yscl/=t}),e()}function h(t,s){i.forEach(e=>{e.xoffset-=t,e.yoffset-=s}),e()}const n=new Cango(t);n.clearCanvas(),n.setWorldCoordsRHC(44-n.rawWidth,44-n.rawHeight),n.drawShape(rectangle(114,80),{x:-17,y:0,fillColor:"rgba(0, 50, 0, 0.12)"});const o=new Shape(rectangle(20,20,2),{fillColor:"rgba(0,0,0,0.2)"});o.enableDrag(null,null,function(){i.forEach(t=>{t.xscl=t.savWC.xscl,t.yscl=t.savWC.yscl,t.xoffset=t.savWC.xoffset,t.yoffset=t.savWC.yoffset}),e()}),n.render(o);const l=new Shape(rectangle(20,20,2),{x:22,y:0,fillColor:"rgba(0,0,0,0.2)"});l.enableDrag(null,null,function(){h(50,0)}),n.render(l);const c=new Shape(rectangle(20,20,2),{x:0,y:22,fillColor:"rgba(0,0,0,0.2)"});c.enableDrag(null,null,function(){h(0,-50)}),n.render(c);const d=new Shape(rectangle(20,20,2),{x:-22,y:0,fillColor:"rgba(0,0,0,0.2)"});d.enableDrag(null,null,function(){h(-50,0)}),n.render(d);const u=new Shape(rectangle(20,20,2),{x:0,y:-22,fillColor:"rgba(0,0,0,0.2)"});u.enableDrag(null,null,function(){h(0,50)}),n.render(u);const p=new Shape(rectangle(20,20,2),{x:-56,y:11,fillColor:"rgba(0,0,0,0.2)"});p.enableDrag(null,null,function(){a(1/1.2)}),n.render(p);const g=new Shape(rectangle(20,20,2),{x:-56,y:-11,fillColor:"rgba(0,0,0,0.2)"});g.enableDrag(null,null,function(){a(1.2)}),n.render(g),n.drawPath(r,{x:0,y:22,strokeColor:"white",lineWidth:2}),n.drawPath(r,{degs:-90,x:22,y:0,strokeColor:"white",lineWidth:2}),n.drawPath(r,{degs:90,x:-22,y:0,strokeColor:"white",lineWidth:2}),n.drawPath(r,{degs:180,x:0,y:-22,strokeColor:"white",lineWidth:2}),n.drawPath(["m",-7,0,"l",14,0,"m",-7,-7,"l",0,14],{x:-56,y:11,strokeColor:"white",lineWidth:2}),n.drawPath(["m",-7,0,"l",14,0],{x:-56,y:-11,strokeColor:"white",lineWidth:2}),n.drawPath(["m",-6,-6,"l",12,12,"m",0,-12,"l",-12,12],{strokeColor:"white",lineWidth:2})}}();